{% extends this.application+'/base.html' %}
{% block content %}
{% include this.application+'/game/topnav.html' %}
<table width="750"><tr><td valign="top">
    <table align="center">
	<tr align="center">
            <td class="l">
                Wiem, że gra ma błędy, więc jeśli jakiś znajdziesz to zgłoś go nam, a nie wykorzystuj!!!<br>
		Błędy można zgłaszać tu: <a href="mailto:admin@ugame.net.pl" style="color:red;font-weight:bold;">admin@ugame.net.pl</a>. Niedługo wrócę do rozwijania gry i wtedy się zacznie :)
            </td>
	</tr>
    </table>
    <br>
    {% if floty %}
    <table>
        <tr>
            <td>
                {% if output.user_data.userprofile.podglad_flota %}
                {% include 'game/overview_body_flota.html' %}
                {% else %}
                {% include 'game/overview_body_flota_short.html' %}
                {% endif %}
            </td>
            <td align="center" width="50">
                <a href="?userprofile_podglad_flota" class="guzik">Zmień prezentacje floty</a>
            </td>
        </tr>
    </table>
    {% endif %}
	</td>
	</tr>
</table>
	
<table width="750">
    <tr>
        <td class="c" colspan="4">
            <div id="rename_form" style="display:none;">
                <form action="">
                    <input type="text" name="rename_planet" value="{{ output.current_planet.name|e }}"><input type="submit" value="Zapisz">
                </form>
            </div>
            <div id="planet_name">
                <a href="javascript:void(0)" title="Zmień nazwę" onclick="javascript:$('#rename_form').show();$('#planet_name').hide();">Planeta "{{ output.current_planet.name|e }}"</a>
                ({{ output.user_data.user.username|e }})
            </div>
        </td>
    </tr>
    <!-- Notificacion del mensaje -->
    <tr>
        <td colspan="4" class="c">
            Wydarzenia
        </td>
    </tr>
    <tr>
        <th>
            <center>
            	&nbsp;
            </center>
        </th>
        <th colspan="2">
            <img src="/media/planeten/{{ output.current_planet.image|e }}.jpg" height="200" width="200">
            <br>
            {% if output.current_zajete.budowanie %}
            {{ output.current_zajete.budowanie.nazwa|e }}
            <br>
            <div style="display:none" id="hbxx1">
                {{ output.current_zajete.budowanie.sekundy|e }}
            </div>
            <div style="color:lime" id="bxx1">
            </div>
            <script language="Javascript1.2">
                                    	  site="/game/overview/";
                                    	  przeskok=0;
                                    	  function t_div_bxx1(){
                                    		  v=new Date();
                                    		  var bxx=document.getElementById('bxx1');
                                    		  var pp = document.getElementById('hbxx1');
                                    		  n=new Date();
                                    		  ss=pp.innerHTML;
                                    		  s=ss-Math.round((n.getTime()-v.getTime())/1000.);
                                    		  m=0;h=0;
                                    		  if(s<0 && przeskok==0){
                                    			  przeskok = 1;
                                    			  document.location.href=site;
                                    		  } else if (s<0){
                                    			  przeskok = 1;
                                    		  }else{
                                    			  if(s>59){
                                    				  m=Math.floor(s/60);
                                    				  s=s-m*60
                                    			  }
                                    			  if(m>59){
                                    				  h=Math.floor(m/60);
                                    				  m=m-h*60
                                    			  }
                                    			  if(s<10){
                                    				  s="0"+s
                                    			  }
                                    			  if(m<10){
                                    				  m="0"+m
                                    			  }
                                    			  bxx.innerHTML=h+":"+m+":"+s
                                    		  }
                                    		  pp.innerHTML=pp.innerHTML-1;
                                    		  window.setTimeout("t_div_bxx1();",999);
                                    
                                    	  }
                                    t_div_bxx1();
                                
            </script>
            {% endif %}
            {% if output.current_zajete.badanie %}
            {{ output.current_zajete.badanie.nazwa|e }}
            <br>
            <div style="display:none" id="hbxx2">
                {{ output.current_zajete.badanie.sekundy|e }}
            </div>
            <div style="color:lime" id="bxx2">
            </div>
            <script language="Javascript1.2">
                                    site="/game/overview/";
                                    przeskok=0;
                                    function t_div_bxx2(){
                                    	v=new Date();
                                    	var bxx=document.getElementById('bxx2');
                                    	var pp = document.getElementById('hbxx2');
                                    	n=new Date();
                                    	ss=pp.innerHTML;
                                    	s=ss-Math.round((n.getTime()-v.getTime())/1000.);
                                    	m=0;h=0;
                                    	if(s<0 && przeskok==0){
                                    		przeskok = 1;
                                    		document.location.href=site;
                                    	} else if (s<0){
                                    		przeskok = 1;
                                    	}else{
                                    		if(s>59){
                                    			m=Math.floor(s/60);
                                    			s=s-m*60
                                    		}
                                    		if(m>59){
                                    			h=Math.floor(m/60);
                                    			m=m-h*60
                                    		}
                                    		if(s<10){
                                    			s="0"+s
                                    		}
                                    		if(m<10){
                                    			m="0"+m
                                    		}
                                    		bxx.innerHTML=h+":"+m+":"+s
                                    	}
                                    	pp.innerHTML=pp.innerHTML-1;
                                    	window.setTimeout("t_div_bxx2();",999);
                                    
                                    }
                                    t_div_bxx2();
                                
            </script>
            {% endif %}
            {% if output.current_zajete.flota %}
            {{ output.current_zajete.flota.nazwa|e }}
            <br>
            <div style="display:none" id="hbxx3">
                {{ output.current_zajete.flota.sekundy|e }}
            </div>
            <div style="color:lime" id="bxx3">
            </div>
            <script language="Javascript1.2">
                                    site="/game/overview/";
                                    przeskok=0;
                                    function t_div_bxx3(){
                                    	v=new Date();
                                    	var bxx=document.getElementById('bxx3');
                                    	var pp = document.getElementById('hbxx3');
                                    	n=new Date();
                                    	ss=pp.innerHTML;
                                    	s=ss-Math.round((n.getTime()-v.getTime())/1000.);
                                    	m=0;h=0;
                                    	if(s<0 && przeskok==0){
                                    		przeskok = 1;
                                    		document.location.href=site;
                                    	} else if (s<0){
                                    		przeskok = 1;
                                    	}else{
                                    		if(s>59){
                                    			m=Math.floor(s/60);
                                    			s=s-m*60
                                    		}
                                    		if(m>59){
                                    			h=Math.floor(m/60);
                                    			m=m-h*60
                                    		}
                                    		if(s<10){
                                    			s="0"+s
                                    		}
                                    		if(m<10){
                                    			m="0"+m
                                    		}
                                    		bxx.innerHTML=h+":"+m+":"+s
                                    	}
                                    	pp.innerHTML=pp.innerHTML-1;
                                    	window.setTimeout("t_div_bxx3();",999);
                                    
                                    }
                                    t_div_bxx3();
                                
            </script>
            {% endif %}
            {% if output.current_zajete.obrona %}
            {{ output.current_zajete.obrona.nazwa|e }}
            <br>
            <div style="display:none" id="hbxx4">
                {{ output.current_zajete.obrona.sekundy|e }}
            </div>
            <div style="color:lime" id="bxx4">
            </div>
            <script language="Javascript1.2">
                                    site="/game/overview/";
                                    przeskok=0;
                                    function t_div_bxx4(){
                                    	v=new Date();
                                    	var bxx=document.getElementById('bxx4');
                                    	var pp = document.getElementById('hbxx4');
                                    	n=new Date();
                                    	ss=pp.innerHTML;
                                    	s=ss-Math.round((n.getTime()-v.getTime())/1000.);
                                    	m=0;h=0;
                                    	if(s<0 && przeskok==0){
                                    		przeskok = 1;
                                    		document.location.href=site;
                                    	} else if (s<0){
                                    		przeskok = 1;
                                    	}else{
                                    		if(s>59){
                                    			m=Math.floor(s/60);
                                    			s=s-m*60
                                    		}
                                    		if(m>59){
                                    			h=Math.floor(m/60);
                                    			m=m-h*60
                                    		}
                                    		if(s<10){
                                    			s="0"+s
                                    		}
                                    		if(m<10){
                                    			m="0"+m
                                    		}
                                    		bxx.innerHTML=h+":"+m+":"+s
                                    	}
                                    	pp.innerHTML=pp.innerHTML-1;
                                    	window.setTimeout("t_div_bxx4();",999);
                                    
                                    }
                                    t_div_bxx4();
                                
            </script>
            {% endif %}
            {% if output.current_zajete.building_free %}
            {{ output.current_zajete.building_free|e }}
            {% endif %}
        </th>
        {% if output.planets %}
        <th class="s" width="100%" valign="top">
            <table class="s" align=center valign="top" border="0" width="100%">
                <tr align=center width="100%" valign="top">
                    <th>
                        {% for p in output.planets %}
                        <div id="tool_{{ p.id|e }}" style="width:100px;height:150px;float:left;display:none;border:1px #415680 solid;font-size:11px;font-family:Tahoma,sans-serif;background-color:#081831;text-align:center" onclick="$('#tool_{{ p.id|e }}').hide();$('#planet_{{ p.id|e }}').show()">
                            <table width="100%">
                                <tr>
                                    <td class="c" align="center">
                                        <a onclick="$('#tool_{{ p.id|e }}').hide();$('#planet_{{ p.id|e }}').show()">zamknij</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="c" align="center">
                                        <a href="/game/overview/?cp={{ p.id|e }}">przejdź</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="c" align="center">
                                        <a href="/game/fs/surowce/?g={{ p.galaxy.galaxy|e }}&s={{ p.galaxy.system|e }}&p={{ p.galaxy.field|e }}">transport</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="c" align="center">
                                        <a href="/game/fs/przeslij/?g={{ p.galaxy.galaxy|e }}&s={{ p.galaxy.system|e }}&p={{ p.galaxy.field|e }}">prześlij</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div id="planet_{{ p.id|e }}" style="height:150px;width:100px;float:left;background-color:#081831;border:1px #415680 solid" onclick="$('#tool_{{ p.id|e }}').show();$('#planet_{{ p.id|e }}').hide()">
                            <table width="100%">
                                <tr>
                                    <td align="center">
                                        {{ p.name|e }}
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center">
                                        <a onclick="$('#tool_{{ p.id|e }}').show();$('#planet_{{ p.id|e }}').hide()" title="{{ p.name|e }}"><img src="/media/planeten/small/s_{{ p.image|e }}.jpg" height="50" width="50"></a>
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center">
                                        <font color="red">
                                            {% if p.zajety_budowaniem() %}B{% endif %}
                                        </font>
                                        <font color="lime">
                                            {% if p.zajety_badaniem() %}R{% endif %}
                                        </font>
                                        <font color="yellow">
                                            {% if p.zajety_obrona() %}O{% endif %}
                                        </font>
                                        <font color="white">
                                            {% if p.zajety_flota() %}F{% endif %}
                                        </font>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        {% endfor %}
                    </th>
                </tr>
            </table>
        </th>
        {% endif %}
    </tr>
    <tr>
        <th>
            Średnica
        </th>
        <th colspan="3">
            {{ output.current_planet.powierzchnia_max|e }} p.<a title="Zabudowane pola"></a>
            zajęte <a title="Dostępne pola do zabudowania">{{ output.current_planet.powierzchnia_zajeta|e }} p.</a>
        </th>
    </tr>
    <tr>
        <th>
            Temperatura
        </th>
        <th colspan="3">
            od {{ output.current_planet.temp_min|e }}°C do {{ output.current_planet.temp_max|e }}°C
        </th>
    </tr>
    <tr>
        <th>
            Położenie
        </th>
        <th colspan="3">
            <a href="/game/galaxy/{{ output.current_galaxy.galaxy|e }}/{{ output.current_galaxy.system|e }}/">
            	[{{ output.current_galaxy.galaxy|e }}:{{ output.current_galaxy.system|e }}:{{ output.current_galaxy.field|e }}]
			</a>
        </th>
    </tr>
    <tr>
        <th>
            Pola zniszczeń
        </th>
        <th colspan="3">
            Metal: {{ output.current_galaxy.metal|intcomma|e }} / Kryształ: {{ output.current_galaxy.crystal|intcomma|e }}
            {% if output.current_galaxy.metal or output.current_galaxy.crystal %}
            (<a href="#/game/quickfleet/?mode=harvest&g={{ output.current_galaxy.galaxy|e }}&s={{ output.current_galaxy.system|e }}&p={{ output.current_galaxy.field|e }}">Recykler</a>)
            {% endif %}
        </th>
    </tr>
    <tr>
        <th>
            Punkty
        </th>
        <th colspan="3">
            {{ output.user_data.user_points|make_int|intcomma|e }} (
            Miejsce <a href="#stat.php?start={{ output.user_data.user_rank|e }}">{{ output.user_data.user_rank|e }}</a>
            z {{ output.other_data.max_users|e }})
            <br>
            Punkty za flotę: {{ output.user_data.userprofile.points_flota|make_int|intcomma|e }}
            <br>
            Punkty za obronę: {{ output.user_data.userprofile.points_obrona|make_int|intcomma|e }}
            <br>
            Punkty za budynki {{ output.user_data.userprofile.points_builds|make_int|intcomma|e }}
            <br>
            Punkty za badania {{ output.user_data.userprofile.points_tech|make_int|intcomma|e }}
        </th>
    </tr>
    <tr>
        <th>
            Poziom wydobycia
        </th>
        <th colspan="3">
            <div style="border: 1px solid rgb(153, 153, 255); width: 250px;float:left">
                <div id="prodBar" style="background-color: #00ff00; width: {{ (output.other_data.procent / 100 * 250)|round|int }}px;">
                    &nbsp;
                </div>
            </div>
			{{ output.other_data.procent|e }}%
        </th>
    </tr>
</table>
<br>
<table>
    <tr>
        <td>
            Time:{{ sqltime|e }}
        </td>
        <td>
            Duplicate:{{ duplicate|e }}
        </td>
    </tr>
</table>

{% endblock %}
